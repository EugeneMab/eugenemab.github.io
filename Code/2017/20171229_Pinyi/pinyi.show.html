<html>
<head>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<script src="pinyi.ime.js">
</script>
<script>
function convert() {
	var src = document.getElementById("src").value;
	var tgt = "";
	var hov = "";
	var lines = src.split('\n');
	for (var row = 0; row < lines.length; row++) {
		var line = lines[row];
		for (var pos = 0; pos < line.length; pos++) {
			var item = line.charAt(pos);
			var mapped = map[item];
			if (!mapped) {
				tgt += item + ' ';
				hov += item + ' ';
				continue;
			}
			tgt += mapped[0] + ' ';
			hov += '<span onclick="t(this,\'' + item + '\',\'' + mapped[1] + '\')">' + mapped[0] + '</span> ';
		}
		tgt += '\n';
		hov += '<br/>';
	}
	document.getElementById("tgt").innerHTML = tgt;
	document.getElementById("hov").innerHTML = hov;
}
function init() {
	convert();
	var srcElem = document.getElementById("src");
	if (srcElem.addEventListener) {
		srcElem.addEventListener("input", function() { convert(); }, false);
	} else if (srcElem.attachEvent) {
		srcElem.attachEvent("onpropertychange", function() { convert(); });
	}
}
function t(element, text, dupes) {
	var prev = element.innerHTML;
	if (prev.substring(0, 1) == text) {
		element.innerHTML = prev.substring(1, prev.length - (dupes.length + 2));
		return;
	}
	element.innerHTML = text + prev + '(' + dupes + ')';
}
</script>
<body style="font-family: Courier; font-size: 24px;" onload="init()">
<textarea id="src" cols="180" rows="25" style="font-family: 宋体, SimSun, Courier; font-size: 24px;">

我你他她它
中国 美国 英国
爸爸 ;妈妈 ;哥哥 ;弟弟 ;姐姐 ;妹妹 ;兄弟姐妹
太阳 ;月亮 ;星星 ;地球 
科学 ;语文 ;数学 ;英语 ;物理 ;地理 ;化学 ;政治 ;生物
一二三四五六七八九十百千万 ;半边 
北京 ;上海 ;广州 ; 城市 ;程序员 ;
光明 ;黑暗 ;空气 ;气功 ; 控制 ;字词 ;词语 ;单词 ;  
不知道为什么
年月日时分秒
东南西北中 前后左右上下 出入来去
如果 那么 因为 所以 不仅 而且 虽然 但是 和或 首先 然后
中华人民共和国

施氏食狮史
石室诗士施氏，嗜狮，誓食十狮。施氏时时适市视狮。十时，适十狮适市。是时，适施氏适市。氏视是十狮，恃矢势，使是十狮逝世。氏拾是十狮尸，适石室。石室湿，氏使侍拭石室。石室拭，氏始试食是十狮尸。食时，始识是十狮尸，实十石狮尸。试释是事。 

季姬击鸡记
季姬寂，集鸡，鸡即棘鸡。棘鸡饥叽，季姬及箕稷济鸡。鸡既济，跻姬笈，季姬忌，急咭鸡，鸡急，继圾几，季姬急，即籍箕击鸡，箕疾击几伎，伎即齑，鸡叽集几基，季姬急极屐击鸡，鸡既殛，季姬激，即记《季姬击鸡记》。

《遗镒疑医》
伊姨殪，遗亿镒。伊诣邑，意医姨疫，一医医伊姨。翌，亿镒遗，疑医，以议医。医以伊疑，缢，以移伊疑。伊倚椅以忆，忆以亿镒遗，以议伊医，亦缢。噫！亦异矣！ 

《易姨医胰》
易姨悒悒，依议诣夷医。医疑胰疫，遗意易姨倚椅，以异仪移姨胰，弋异蚁一亿，胰液溢，蚁殪，胰以医。易胰怡怡，贻医一夷衣。医衣夷衣，怡怡奕奕。噫！以蚁医胰，异矣！以夷衣贻夷医亦宜矣！ 

《熙戏犀》
赵元任 西溪犀，喜嬉戏。席熙夕夕携犀徙，席熙细细习冼犀。犀吸溪，戏袭熙。席熙嘻嘻希息戏。惜犀嘶嘶喜袭熙。 

《饥鸡集矶记》
唧唧鸡，鸡唧唧。几鸡挤挤集矶脊。机极疾，鸡饥极，鸡冀己技击及鲫。机既济蓟畿，鸡计疾机激几鲫。机疾极，鲫极悸，急急挤集矶级际。继即鲫迹极寂寂，继即几鸡既饥，即唧唧 

《侄治痔》
芝之稚侄郅，至智，知制纸，知织帜，芝痔炙痔，侄至芝址，知之知芷汁治痔，至芷址，执芷枝， 蜘至，踯侄，执直枝掷之，蜘止，侄执芷枝至芝，芝执芷治痔，痔止。

《羿裔熠邑彝》
羿裔熠①，邑②彝，义医，艺诣。 熠姨遗一裔伊③，伊仪迤，衣旖，异奕矣。 熠意④伊矣，易衣以贻伊，伊遗衣，衣异衣以意异熠，熠抑矣。 伊驿邑，弋一翳⑤，弈毅⑥。毅仪奕，诣弈，衣异，意逸。毅诣伊，益伊，伊怡，已臆⑦毅矣，毅亦怡伊。 翌，伊亦弈毅。毅以蜴贻伊，伊亦贻衣以毅。 伊疫，呓毅，癔异矣，倚椅咿咿，毅亦咿咿。 毅诣熠，意以熠，议熠医伊，熠懿⑧毅，意役毅逸。毅以熠宜伊，翼逸。 熠驿邑以医伊，疑伊胰痍⑨，以蚁医伊，伊遗异，溢，伊咦。熠移伊，刈薏⑩以医，伊益矣。 伊忆毅，亦呓毅矣，熠意伊毅已逸，熠意役伊。伊异，噫，缢。 熠癔，亦缢。 

注解： ①熠：医生，据说为后羿的后裔。 ②邑：以彝为邑，指居住在一个彝族聚居的地方。 ③伊：绝世佳丽，仪态万方，神采奕奕。 ④意：对伊有意思，指熠爱上了伊。 ⑤翳：有遮蔽的地方，指伊游弋到了一个阴凉的地方。 ⑥毅：逍遥不羁的浪人，善于下棋，神情坚毅，目光飘逸。 ⑦臆：主观的感觉，通“意”，指对毅有好感。 ⑧懿：原意为“懿旨”，此处引申为要挟，命令。 ⑨胰痍：胰脏出现了疮痍。 ⑩刈：割下草或者谷物一类。薏：薏米，白色，可供食用，也可入药。（居然还有注释。。）

《于瑜与余欲渔遇雨》
于瑜欲渔，遇余于寓。语余：“余欲渔于渝淤，与余渔渝欤？” 余语于瑜：“余欲鬻玉，俞禹欲玉，余欲遇俞于俞寓。” 余与于瑜遇俞禹于俞寓，逾俞隅，欲鬻玉于俞，遇雨，雨逾俞宇。余语于瑜：“余欲渔于渝淤，遇雨俞寓，雨逾俞宇，欲渔欤？鬻玉欤？” 于瑜与余御雨于俞寓，俞鬻玉于余禹，雨愈，余与于瑜踽踽逾俞宇，渔于渝淤。

</textarea>
<div id="hov" style="font-family: Calibri, Arial, sans-serif; font-size: 24px;">
</div>
<br/>
<textarea id="tgt" cols="180" rows="25" style="font-family:Calibri, Arial, sans-serif; font-size: 24px;">
</textarea>
<br/>
</body>
</html>
